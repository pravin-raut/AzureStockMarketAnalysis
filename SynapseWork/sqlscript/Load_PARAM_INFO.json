{
	"name": "Load_PARAM_INFO",
	"properties": {
		"folder": {
			"name": "Process"
		},
		"content": {
			"query": "Delete from PARAM_INFO;\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'PROCESS_NAME','Nifty');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'CONTAINER_NAME','stockdata');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'DIRECTORY_NAME','activitystockdata');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'FUNCTION_NAME','readfromyfinance');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'ticker','^NSEI');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'start_day','2021-07-10');\nINSERT INTO PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES (1,'end_day','2023-07-10');\ninsert into PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES(1,'SCHEMA_NAME','dbo');\ninsert into PARAM_INFO (PARAM_ID,PARAM_NAME,PARAM_VALUE) VALUES(1,'TABLE_NAME','STG_ActivityData');\n\nDECLARE @PROCESS_NAME  varchar(10);\nset @PROCESS_NAME='Nifty';\nselect * from PARAM_INFO where PARAM_VALUE=@PROCESS_NAME \n\n\n--delete from TaskData;\nDECLARE @PROCESS_NAME  varchar(10);\nset @PROCESS_NAME='Nifty';\nUpdate PARAM_INFO\nset \nPARAM_VALUE=format(DATEADD(Day,1,(select PARAM_VALUE from PARAM_INFO where PARAM_NAME='end_day' and PARAM_ID=(select PARAM_ID from PARAM_INFO where PARAM_VALUE=@PROCESS_NAME ))),'yyyy-MM-dd')\nwhere PARAM_NAME='end_day'\nand PARAM_ID=(select PARAM_ID from PARAM_INFO where PARAM_VALUE=@PROCESS_NAME);\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "stockdata",
				"poolName": "stockdata"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}